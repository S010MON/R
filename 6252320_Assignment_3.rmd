---
title: "6252320_Assignment_3"
author: "Leon Debnath"
date: "02/10/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Assignment 3

## Exercise 1

The Beta distribution $Beta(a, b)$ has the following Probability Density Function (PDF):
$$
f(x) =cx^{a-1}(1-x)^{b-1}, \text{ for } 0< x <1,
$$
Using the previous values from the last exercise where: $a = 5,$ $b = 2,$ and $c = 30$ that gives us:

$$
\begin{array}{rcl}
f(x) & = & 30 x ^{(5-1)} (1-x)^{(2-1)} \\
 & = & 30 x ^{4} \cdot (1-x)\\
 & = & 30x^{4} - 30x^{5}
\end{array}
$$
As integrating the PDF gives us the CDF, and integrating between the median and $1$ (or $0$ and the median) should give us a probability of $0.5$ we can set:
$$
\int_{0}^{1} f(x) \text{ }dx =  \int_{m}^{1} 30x^{4} - 30x^{5} \text{ }dx = \frac{30}{5}x^{5} - \frac{30}{6}x^{6} = 6x^{5} - 5x^{6} = 0.5
$$
Thus we can define a new function:
$$
\begin{array}{rcl}
g(x) & = & 6x^{5} - 5x^{6} = 0.5 \\
 & = & 6x^{5} - 5x^{6} - 0.5 = 0\\
\end{array} 
$$

Finding the root of g(x) will compute the median:
```{r}
f <- function(x) { 30*x^4 - 30 * x ^ 5}
g <- function(x) { (6 * x^5) - (5 * x^6) - 0.5}

median_est = uniroot(g, c(0,1))
median_est$root
```

To check the answer, we can use built in functions dbeta and median to calculate the true value.

```{r}
X <- seq(0, 1, by = 0.02)
Y <- dbeta(X, shape1=5, shape2=2)
median_act <- median(Y, na.rm = FALSE)
median_act
```
Plotting both answers indicates that the two values are indeed close to each other
```{r}
plot(X,Y)
abline(v=median_est$root, col='red')
text(0.80, 1, labels='Est', col='red')
abline(v=median_act, col='blue')
text(0.65, 1, labels='Act', col='blue')

sprintf("The estimated median is: %f", median_est)
sprintf("The calculated median is: %f", median_act)
```
## Exercise 2

The Central Limit Theorem (CLT) states that given a sufficiently large sample size, the sampling distribution of the sample means approaches a normal distribution â€” no matter what the shape of the population distribution.

In the case of a Galton Board the probability of a ball landing in any given slot can be calculated by counting the number of paths that lead there and then dividing that value by the total number of paths. The resulting distribution is discrete and can be calculated by evaluating the Binomial function:
$$
f(k, n) = {}_{n} C_{k} \cdot P(k,n) 
$$
By taking the mean of the binomial we can simulate the final slot that the ball lands in.  Summing the number of times the mean value equals the value of each slot (rounding to the nearest integer) is equivalent to allowing each slot to fill with multiple balls.  Given a large enough sample size, by the CLT the values will form a normal distribution as plotted below

```{r}
balls_dropped <- 10^5
slots <- 50
balls_per_slot <- rep(0, slots)
for(ball in 1:balls_dropped)
{
  mean <- rbinom(1, slots, 0.5)                      # Calculate the final landing place
  mean <- trunc(mean)                                # Truncate to integer value
  balls_per_slot[mean] <- balls_per_slot[mean] + 1   # Increment the sum for the slot
}
plot(balls_per_slot)
```
